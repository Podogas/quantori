<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./style.css">
    <title>Document</title>
</head>
<body>
    <main class="screen">
        <label for="volume">Громкость</label>
        <input name="volume" id="volumeInput" type="range" value="0.25" min="0" max="1" step="0.01" onchange="changeVolume()">
        <div class="warning-box hidden">
            <p class="warning-box__description">Please, enable sound. You can do it by clicking on the button below, or by clicking on page</p>
            <button class="warning-box__btn" type="button" onclick="hideWarningBox()">enable</button>
        </div>   
        <h1 class="screen__heading">Pure Madness</h1>
        <section class="cubic-screen">
            <section class="cubic-screen__container">
                <div class="cube__wrapper">
                    <figure class="cube__edge cube__edge_right">
                        <div class="horizontal-movement-wrapper">
                            <div class="vertical-movement-wrapper">
                                <img class="dvd-logo dvd-logo_first" src="./dvd_logo.png" alt="dvd logo">
                            </div>
                        </div>
                    </figure>
                    <figure class="cube__edge cube__edge_left">
                        <div class="horizontal-movement-wrapper">
                            <div class="vertical-movement-wrapper">
                                <img class="dvd-logo dvd-logo_first" src="./dvd_logo.png" alt="dvd logo">
                            </div>
                        </div>
                    </figure>
                    <figure class="cube__edge cube__edge_front">
                        <div class="horizontal-movement-wrapper">
                            <div class="vertical-movement-wrapper">
                                <img class="dvd-logo dvd-logo_first" src="./dvd_logo.png" alt="dvd logo">
                            </div>
                        </div>
                    </figure>
                    <figure class="cube__edge cube__edge_back">
                        <div class="horizontal-movement-wrapper">
                            <div class="vertical-movement-wrapper">
                                <img class="dvd-logo dvd-logo_first" src="./dvd_logo.png" alt="dvd logo">
                            </div>
                        </div>
                    </figure>
                    <figure class="cube__edge cube__edge_top">
                        <div class="horizontal-movement-wrapper">
                            <div class="vertical-movement-wrapper">
                                <img class="dvd-logo dvd-logo_first" src="./dvd_logo.png" alt="dvd logo">
                            </div>
                        </div>
                    </figure>
                    <figure class="cube__edge cube__edge_bottom">
                        <div class="horizontal-movement-wrapper">
                            <div class="vertical-movement-wrapper">
                                <img class="dvd-logo dvd-logo_first" src="./dvd_logo.png" alt="dvd logo">
                            </div>
                        </div>
                    </figure>  
                </div>
            </section>
        </section>
    </div>
</main>

<script>
const allAudioArray = [];   
const warningBoxEl = document.getElementsByClassName('warning-box')[0];
const volumeInputEl = document.getElementById('volumeInput');   
const horizontalMovementWrapperElList = Array.from(document.getElementsByClassName('horizontal-movement-wrapper')); 
const verticalMovementWrapperElList = Array.from(document.getElementsByClassName('vertical-movement-wrapper'));
const regexp = /(?<=[\s]).*(?=s,)/;
const hideWarningBox = () => {
    warningBoxEl.classList.add('hidden');
}
const changeVolume = () => {
    allAudioArray.forEach(audio => {
        
        audio.volume = volumeInputEl.value;
        console.log(audio.volume, 'volume')
    })
    }
    horizontalMovementWrapperElList.forEach(element => {
        const horComputedStyle = window.getComputedStyle(element);
        const horAnimationCycleLengthInMs = (horComputedStyle.animationDuration.match(regexp)[0])*100;
        const clickSound = new Audio('./audio/laserSFX.mp3');
        allAudioArray.push(clickSound);
        // this line waiting for 1 spesific animation to  be ready, but all animations are getting ready pretty at the same time so i used this aproach, i think its sutable for our hw 
        document.getAnimations()[1].ready.then((result) => {
            syncSound();
        } )
        function syncSound() {
            warningBoxEl.classList.add('hidden')
            setInterval(() => {
                console.log(element)
                clickSound.play().catch((error) => {
                    warningBoxEl.classList.remove('hidden');
                    console.log(error.message);
                })
            }, horAnimationCycleLengthInMs);
        }    
    })
    verticalMovementWrapperElList.forEach(element => {
        const verComputedStyle = window.getComputedStyle(element);
        const verAnimationCycleLengthInMs = (verComputedStyle.animationDuration.match(regexp)[0])*100;
        const clickSound = new Audio('./audio/laserSFX.mp3');
        allAudioArray.push(clickSound);
        document.getAnimations()[1].ready.then((result) => {
            syncSound();
        } )
        function syncSound() {
            setInterval(() => {
                console.log(allAudioArray[0].volume)
                warningBoxEl.classList.add('hidden')
                clickSound.play().catch((error) => {
                    warningBoxEl.classList.remove('hidden');
                    console.log(error.message);
                })
            }, verAnimationCycleLengthInMs);
        }    
            
})
changeVolume();
// const horComputedStyle = window.getComputedStyle(horizontalMovementWrapperElList[0]);
// const verComputedStyle = window.getComputedStyle(verticalMovementWrapperElList[0]);
// <script>    
//     const horizontalMovementWrapperEl = document.getElementsByClassName('horizontal-movement-wrapper')[0]; 
//     const verticalMovementWrapperEl = document.getElementsByClassName('vertical-movement-wrapper')[0];          
//     const audioVerEl = document.getElementById('audio-ver');
//     const audioHorEl = document.getElementById('audio-hor');

//     const horComputedStyle = window.getComputedStyle(horizontalMovementWrapperEl);
//     const verComputedStyle = window.getComputedStyle(verticalMovementWrapperEl);
//     const regexp = /(?<=[\s]).*(?=s,)/;
//     const horAnimationCycleLengthInMs = (horComputedStyle.animationDuration.match(regexp)[0])*100;
//     const verAnimationCycleLengthInMs = (verComputedStyle.animationDuration.match(regexp)[0])*100;
//     setInterval(() => {
//             audioVerEl.play(); 
//     }, horAnimationCycleLengthInMs);
//     setInterval(() => {
//             audioHorEl.play();  
//     }, verAnimationCycleLengthInMs);



</script>
</body>
</html>